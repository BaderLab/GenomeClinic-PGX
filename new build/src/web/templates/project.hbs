{{!-- Render the initial project page --}}
{{#if projectPage}}
<div class="row">
    <div class="large-12 columns">
      	<h2><i class="fi-page-multiple"></i>&nbsp Projects</h2>
      	<h5 class="subheader">Displaying all available projects</h5>
     	<p>Projects offer you a way to conveniently group individual patients together to easily view information that is being stored for each of them. A single patient can be included in as many projects as you want. Additionally projects also offer you the opportunity to share patients with individuals by granting them access to a patient. Just a warning, granting someone privileges means they can also grant another individual privileges as well.</p>
      	<div class="row">
        	<div class="large-3 columns">
          		<a href="#" class="button alert radius left" id="add-new-project">Add New Project</a>
        	</div>
      	</div> 
    </div>
</div>
<div class="row">
	<div class="large-12 columns">     
		{{!-- Add the project table --}}
    {{#if projects}}
  		<table class="large-12">
  			<thead>
  				<tr>
  					<th>Project Name</th>
  					<th>Date Created</th>
  					<th class="text-center">Number Of Patients</th>
  					<th class="text-center">Keywords</th>
  				</tr>
  			</thead>
  			<tbody>
  				{{#each projects}}
  				<tr class="project-row">
  					<td class="frangipani-project-name">{{project_id}}</a></td>
  					<td>{{date}}</td>
  					<td class="text-center">{{numPatients}}</td>
  					<td class="text-center">{{keywords}}</td>
  				</tr>
  				{{/each}}
  			</tbody>
  		</table>
    {{else}}
    <div data-alert class="alert-box radius secondary" id="error-display-box">
      <!-- Alert message goes here -->
      <div class="row">
          <div class="small-11 columns">
              <p id="error-display-message">There does not appear to be anything here</p>
          </div>
        </div>
    </div>
    {{/if}}
	</div>
</div>
{{/if}}



{{!-- When New Project button selected, render the add New Project Page --}}
{{#if addProjectPage}}
<div class="row">
    <div class="large-12 columns" style="margin-top:20px">
        <a href="/projects" class="button radius"><i class="fa fa-arrow-left"></i>&nbspBack</a>
      	<h2><i class="fi-page-multiple"></i>&nbsp&nbspAdd New Project</h2>
        <div class="row">
          <div class="large-12 columns">
            <form id="frangipani-add-new-project" style="margin-top:40px">
              <fieldset>
                <legend>Project Information </legend>
                <div class="row">
                <div class="small-12 columns">
                  <div data-alert class="alert-box radius alert" id="error-display-box"  style="display:none">
                    <!-- Alert message goes here -->
                    <div class="row">
                      <div class="small-11 columns">
                        <p id="error-display-message"></p>
                      </div>
                      <div class="small-1 columns">
                        <a href="#" class='close-box'><i class="fi-x size-16" style="color:#606060"></i></a>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="large-12 columns">
            	      <div class="row collapse prefix-radius">
                      <div class="large-3 columns">
                        <span class="prefix">Project Name</span></span>
                      </div>
                      <div class="large-9 columns">
                        <input type="text" id='project_id' name='project_id'> 
                        <small class="error" style="display:none;">That project Id alredy exists</small>
                      </div>
                    </div>
                    <div class="row collapse prefix-radius">
                      <div class="large-3 columns">
                        <span class="prefix">Keywords</span>
                      </div>
                      <div class="large-9 columns">
                        <input type="text" id='keywords' name='keywords'>
                      </div>
                    </div>
                    <div class="row collapse prefix-radius">
                      <div class="large-3 columns">
                        <span class="prefix">Project Description</span>
                      </div>
                      <div class="large-9 columns">
                        <textarea id="description" rows=5></textarea>
                      </div>
                    </div>
                    <div class="row collapse prefix-radius postfix-radius">
                      <div class="large-3 columns">
                        <span class="prefix">Add Authorized User</span>
                      </div>
                      <div class="large-8 columns">
                        <input type="text" id='new-user' name='new-user'>
                        <small class="error" style="display:none">That user does not exist</small>
                      </div>
                      <div class="large-1 columns">
                        <a href="#" class="postfix button secondary" id="add-auth-user"><i class="fi-plus"></i></a>
                      </div>
                    </div>
                    <div class="row collapse prefix-radius">
                      <div class="large-3 columns">
                        <span class="prefix">Authorized Users</span></span>
                      </div>
                      <div class="large-9 columns">
                        <table class="large-12">
                          <thead>
                            <tr>
                              <th class="large-9">Email</th>
                              <th class="large-3 text-center">Remove</th>
                            </tr>
                          <tbody id='auth-users'>
                            <tr>
                              <td>You</td>
                              <td class='text-center'>Cannot Remove</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
          	    </div>
                <div class="row">
                  <div class="large-12 columns" id='patient_id_links' style="min-height:150px;">
                    <div class="large-8 columns">
                      <h4>Patients to add to project</h4>
                    </div>
                    <div class="large-3 columns right">
                      <a href="#" id="remove-all-visible" class="tiny button radius alert right">Remove All Patients</a>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="large-4 columns">
                    <a href="#" class="button alert round large-12" id="submit-new-project">Submit</a>
                  </div>
                </div>
              </fieldset>
            </form>
          </div>
        </div>
        <hr>
        <div  class="row">
          <div class="large-12 columns">
            <p>Search through the available patients and select those that you would like to add to your new project. To add a patient simply click on them in the table!</p> 
            <div class="row collapse prefix-radius">
              <div class="large-2 columns">
                <span class="prefix">Search</span>
              </div>
              <div class="large-6 small-8 columns left">
                <input type="text" id="searchBox" name="searchBox">
              </div>
              <div class="large-3 small-2 columns right">
                <a href="#" id="add-all-visible" class="right tiny button alert radius">Add All Active Patients</a>
              </div>
            </div>
            <div class="large-12 columns" id="patient-information">
            </div>
          </div>
        </div>
    </div>
</div>
{{/if}} 


{{#if projectInfoPage}}
	<div class="row">
    	<div class="large-12 columns" style="margin-top:20px">

    	<a href="/projects" class="button radius"><i class="fa fa-arrow-left"></i>&nbspBack</a>
    	<div class="row">
	    	<div class="large-9 columns">
	    		<h2><i class="fi-book"></i>&nbsp{{project_id}}</h2>
	    	</div>
        {{#if isOwner}}
	    	<div class="large-3 columns">
	    		<a href="#" class="button radius right" id='delete-project'>Delete Project</a>
	    	</div>
        {{/if}}
	    </div>
	    
    	<fieldset>
    		<legend>Project Information</legend>
        <div class="row">
          <div class="large-10 columns">
    		    <h4>Created on: {{date}}</h4>
          </div>
          {{#if isOwner}}
          <div class="large-2 columns text-center">
            <a href="#" id="edit-page"><i class="fi-pencil size-24" style="color:#A2A2A2"></i></a>
          </div>
          {{/if}}
        </div>
        <div class="row">
          <div class="large-12 columns" id="fixed-details">
        		{{#if keywords}}

        		<h4>Project Keywords</h4>
        		<p>{{keywords}}</p>
        		{{/if}}
        		{{#if description}}
        		<h4>Project Description</h4>
        		<p>{{description}}</p>
        		{{/if}}
        		<h4>Authorized Users</h4>
            <span class="button radius secondary" data-id="{{owner}}">{{owner}}</span>
    	    	{{#each users}}
    	    		<span class="button radius secondary" data-id="{{this}}">{{this}}</span>
    	    	{{/each}}
          </div>
        </div>
        {{#if isOwner}}
        <div class="row">
          <div class="large-12 columns" style="display:none;" id="change-details">
            <h4>Project Keywords</h4>
            <input type="text" id="keywords" value="{{keywords}}">
            <h4>Project Description</h4>
            <textarea id="description" rows=5>{{description}}</textarea>
            <div class="row collapse prefix-radius postfix-radius">
              <div class="large-3 columns">
                <span class="prefix">Add Authorized User</span>
              </div>
              <div class="large-8 columns">
                <input type="text" id='new-user' name='new-user'>
                <small class="error" style="display:none">That user does not exist</small>
              </div>
              <div class="large-1 columns">
                <a href="#" class="postfix button secondary" id="add-auth-user"><i class="fi-plus"></i></a>
              </div>
            </div>

            <div class="large-12 columns">
              <table class="large-12">
                <thead>
                  <tr>
                    <th class="large-9">Email</th>
                    <th class="large-3 text-center">Remove</th>
                  </tr>
                <tbody id='auth-users'>
                  <tr>
                    <td>Owner</td>
                    <td class="text-center">Cannot Remove</td>
                  </tr>
                  {{#each users}}
                  <tr>
                    <td class="auth-user-email" data-id="{{this}}">{{this}}</td>
                    <td class='text-center'><a href="#"><i class="fi-x size-16"></i></td>
                  </tr>
                  {{/each}}
                </tbody>
              </table>
            <div class="row">
              <div class='large-6 columns' style="margin-top:40px">
                <a href="#" class="button radius large-12 left confirm success">Submit</a>
              </div>
              <div class='large-6 columns' style="margin-top:40px">
                <a href="#" class="button radius alert large-12 right cancel">cancel</a>
              </div>
            </div>
          </div>
        </div>
        {{/if}}
      </fieldset>
      {{#if isOwner}}
    	<div class="row">
    		<div class="large-4 columns">
    			<a href="#" class="button alert radius" id="add-patients">Add Patients to Project</a>
    		</div>
    		<div class="large-8 columns right">
    			<a href="#" class="button alert radius right" id="remove-patients">Remove Patients From Project</a>
    		</div>
    	</div>

    	<div id="add-patients-modal" class="reveal-modal large" data-reveal>
		  	<h2>Select Which patients you would like to add</h2>
		  	<div class="row">
                <div class="large-12 columns" id='patient_id_links' style="min-height:100px;margin-bottom:20px">
                  <h4>Patients to add to project (click to remove)</h4>
                </div>
          	</div>

          	<div class="row collapse prefix-radius">
              <div class="large-2 columns">
                <span class="prefix">Search</span>
              </div>
              <div class="large-6 columns left">
                <input type="text" id="searchBox" name="searchBox">
              </div>
            </div>
          	<div class="row">
          		<div class="scrollit large-12 columns" id="patient-information">
          		</div>
            </div>

		  	<div class="row">
		  		<div class='large-6 columns'>
		  			<a href="#" class="large-12 button radius success confirm">Confirm</a>
		  		</div>
		  		<div class="large-6 columns">
		  			<a href="#" class="large-12 button radius alert cancel">Cancel</a>
		  		</div>
		  	</div>
		  	<a class="close-reveal-modal">&#215;</a>
		</div>

		<div id="confirm-removal" class="reveal-modal large" data-reveal>
		  <h3></h3>
		  <div class="row">
		  	<div class='large-6 columns'>
		  		<a href="#" class="large-12 button radius success confirm">Confirm</a>
		  	</div>
		  	<div class="large-6 columns">
		  		<a href="#"class="large-12 button radius alert cancel">Cancel</a>
		  	</div>
		  </div>
		  <a class="close-reveal-modal">&#215;</a>
		</div>
    {{/if}}
		<div class="row">
            <div class="small-12 columns">
                <div data-alert class="alert-box radius secondary" id="error-display-box"  style="display:none">
                <!-- Alert message goes here -->
                	<div class="row">
                    	<div class="small-11 columns">
                       		<p id="error-display-message"></p>
                    	</div>
                    	<div class="small-1 columns">
                        	<a href="#" class='close-box'><i class="fi-x size-16" style="color:#606060"></i></a>
                    	</div>
                	</div>
            	</div>
        	</div>
        </div>


    	<div class="row">
    		<div class="large-12 columns" id="patients-table">
    		</div>
    	</div>
{{/if}}


{{!-- Render a new row for an Authenticated user --}}
{{#if addAuthUser}}
	<tr>
		<td class="auth-user-email">{{user}}</td>
		<td class='text-center'><a href="#"><i class="fi-x size-16"></i></td>
	</tr>
{{/if}}