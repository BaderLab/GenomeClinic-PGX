/*
 * Module that manages correspondence with a GA4GH-compliant server.
 * @author Ron Ammar
 */

var request= require("request");
var Promise= require("bluebird");


// Google Genomics URL and API key associated with Lab IP address
var rootUrl= "https://www.googleapis.com/genomics/v1beta2/";
var myAPIKey= "AIzaSyDQ37_4RW9gHeWxwaEn1Ab-7_kHAAFLXXM";


/* Gets all projects from the specified GA4GH-compliant server. 
 * @return {Object} A promise describing state of request. */
exports.getProjects= function() {
	var options= {
		url: rootUrl + "datasets" + "?key=" + myAPIKey,
		method: "GET",
		json: true
	};

	var promise= new Promise(function(resolve, reject) {
		request(options, function(err, httpResponse, body) {
			if (err) {
				reject(err);
			}

			resolve(body);
		});
	});

	return promise;
}

/* Gets all patients from the specified GA4GH-compliant server. 
 * @return {Object} A promise describing state of request. */
exports.getPatients= function(projectOptions) {
	var options= {
		url: rootUrl + "callsets/search" + "?key=" + myAPIKey,
		method: "POST",
		json: true,
		body: projectOptions
	};

	var promise= new Promise(function(resolve, reject) {
		request(options, function(err, httpResponse, body) {
			if (err) {
				reject(err);
			}

			resolve(body);
		});
	});

	return promise;
}









